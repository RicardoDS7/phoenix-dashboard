(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[41],{3843:(e,s,a)=>{"use strict";a.d(s,{db:()=>o});var r=a(3915),t=a(5317);let i=(0,r.Wp)({apiKey:"AIzaSyDKxm2rzvjgsxfg1vJ6ZgzPJRPfY3R7HR4",authDomain:"phoenix-energy-firebase.firebaseapp.com",projectId:"phoenix-energy-firebase",storageBucket:"phoenix-energy-firebase.firebasestorage.app",messagingSenderId:"82665667347",appId:"1:82665667347:web:a6dab9227aa655573638e6",measurementId:"G-1CQS4L7V4Y"}),o=(0,t.aU)(i)},5695:(e,s,a)=>{"use strict";var r=a(8999);a.o(r,"useRouter")&&a.d(s,{useRouter:function(){return r.useRouter}})},7209:(e,s,a)=>{Promise.resolve().then(a.bind(a,8305))},8305:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>l});var r=a(5155),t=a(2115),i=a(5317),o=a(3843),n=a(5695);function l(){let e=(0,n.useRouter)(),[s,a]=(0,t.useState)([]),[l,c]=(0,t.useState)([]),[d,u]=(0,t.useState)(""),[g,m]=(0,t.useState)({projectName:"",siteAddress:"",latitude:"",longitude:"",projectEPC:"",projectDetails:"",tariffType:"",nmd:"",usage:{jan:"",feb:"",mar:"",apr:"",may:"",jun:"",jul:"",aug:"",sep:"",oct:"",nov:"",dec:""},fractions:{offpeak:"",standard:"",peak:""}});(0,t.useEffect)(()=>{(async function(){try{let e=(await (0,i.GG)((0,i.rJ)(o.db,"eskom_tariffs"))).docs.map(e=>e.id);a(e)}catch(e){console.error("Error fetching eskom_tariffs:",e)}})()},[]),(0,t.useEffect)(()=>{(async function(){try{let e=(await (0,i.GG)((0,i.rJ)(o.db,"clients"))).docs.map(e=>e.id);c(e)}catch(e){console.error("Error fetching clients:",e)}})()},[]),(0,t.useEffect)(()=>{(async function(){if(d)try{let e=(0,i.H9)(o.db,"clients",d),s=await (0,i.x7)(e);if(s.exists()){let e=s.data().projectDetails;m({projectName:d,siteAddress:e.siteAddress||"",latitude:e.latitude||"",longitude:e.longitude||"",projectEPC:e.projectEPC||"",projectDetails:e.projectDetails||"",tariffType:e.tariffType||"",nmd:e.nmd||"",usage:{...e.usage},fractions:{...e.fractions}})}else console.error("No such client document!")}catch(e){console.error("Error loading client data:",e)}})()},[d]);let p=e=>{let{name:s,value:a}=e.target;s in g.usage?m(e=>({...e,usage:{...e.usage,[s]:a}})):s in g.fractions?m(e=>({...e,fractions:{...e.fractions,[s]:a}})):m(e=>({...e,[s]:a}))},f=async()=>{try{if(!d){alert("Please select a client to edit.");return}await (0,i.BN)((0,i.H9)(o.db,"clients",d),{projectDetails:{siteAddress:g.siteAddress,latitude:g.latitude,longitude:g.longitude,projectEPC:g.projectEPC,projectDetails:g.projectDetails,tariffType:g.tariffType,nmd:g.nmd,usage:{...g.usage},fractions:{...g.fractions},updatedAt:new Date}},{merge:!0}),alert("Client updated successfully!")}catch(e){console.error("Error updating client:",e),alert("Error updating client. Check console for details.")}};return(0,r.jsxs)("div",{className:"min-h-screen flex flex-col justify-center items-center p-4",children:[(0,r.jsx)("h1",{className:"text-6xl font-black mb-16",children:"Edit Client Details"}),(0,r.jsx)("div",{className:"w-full max-w-4xl mb-8",children:(0,r.jsxs)("label",{className:"block",children:[(0,r.jsx)("span",{className:"text-gray-700",children:"Select Client (Project Name)"}),(0,r.jsxs)("select",{value:d,onChange:e=>u(e.target.value),className:"mt-1 px-4 py-2 bg-gray-100 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:!0,children:[(0,r.jsx)("option",{value:"",children:"Select a client"}),l.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})]})}),d&&(0,r.jsxs)("form",{className:"grid grid-cols-1 gap-6 max-w-4xl w-full",onSubmit:e=>e.preventDefault(),children:[(0,r.jsxs)("label",{className:"block",children:[(0,r.jsx)("span",{className:"text-gray-700",children:"Project Name"}),(0,r.jsx)("input",{type:"text",name:"projectName",value:g.projectName,onChange:p,className:"mt-1 px-4 py-2 bg-gray-100 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",disabled:!0})]}),(0,r.jsxs)("label",{className:"block",children:[(0,r.jsx)("span",{className:"text-gray-700",children:"Site Address"}),(0,r.jsx)("input",{type:"text",name:"siteAddress",value:g.siteAddress,onChange:p,className:"mt-1 px-4 py-2 bg-gray-100 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,r.jsxs)("label",{className:"block",children:[(0,r.jsx)("span",{className:"text-gray-700",children:"Latitude"}),(0,r.jsx)("input",{type:"text",name:"latitude",value:g.latitude,onChange:p,className:"mt-1 px-4 py-2 bg-gray-100 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"})]}),(0,r.jsxs)("label",{className:"block",children:[(0,r.jsx)("span",{className:"text-gray-700",children:"Longitude"}),(0,r.jsx)("input",{type:"text",name:"longitude",value:g.longitude,onChange:p,className:"mt-1 px-4 py-2 bg-gray-100 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"})]})]}),(0,r.jsxs)("label",{className:"block",children:[(0,r.jsx)("span",{className:"text-gray-700",children:"Project EPC"}),(0,r.jsx)("input",{type:"text",name:"projectEPC",value:g.projectEPC,onChange:p,className:"mt-1 px-4 py-2 bg-gray-100 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"})]}),(0,r.jsxs)("label",{className:"block",children:[(0,r.jsx)("span",{className:"text-gray-700",children:"Project Details"}),(0,r.jsx)("textarea",{name:"projectDetails",value:g.projectDetails,onChange:p,className:"mt-1 py-2 px-4 block w-full rounded-md bg-gray-100 border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"})]}),(0,r.jsx)("h3",{className:"text-2xl font-bold mt-6",children:"Tariff Details"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,r.jsxs)("label",{className:"block",children:[(0,r.jsx)("span",{className:"text-gray-700",children:"Tariff Type"}),(0,r.jsxs)("select",{name:"tariffType",value:g.tariffType,onChange:p,className:"mt-1 px-4 py-2 bg-gray-100 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",children:[(0,r.jsx)("option",{value:"",children:"Select a Tariff"}),s.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})]}),(0,r.jsxs)("label",{className:"block",children:[(0,r.jsx)("span",{className:"text-gray-700",children:"NMD (kVA)"}),(0,r.jsx)("input",{type:"number",name:"nmd",value:g.nmd,onChange:p,className:"mt-1 px-4 py-2 bg-gray-100 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"})]})]}),(0,r.jsx)("h3",{className:"text-2xl font-bold mt-6",children:"Energy Consumption (Last 12 Months)"}),(0,r.jsx)("div",{className:"grid grid-cols-3 gap-6",children:Object.entries(g.usage).map(e=>{let[s,a]=e;return(0,r.jsxs)("label",{className:"block",children:[(0,r.jsxs)("span",{className:"text-gray-700 capitalize",children:[s," (kWh)"]}),(0,r.jsx)("input",{type:"number",name:s,value:a,onChange:p,className:"mt-1 px-4 py-2 bg-gray-100 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"})]},s)})}),(0,r.jsx)("h3",{className:"text-2xl font-bold mt-6",children:"Time-Of-Use Distribution (Estimate)"}),(0,r.jsx)("div",{className:"grid grid-cols-3 gap-6",children:Object.entries(g.fractions).map(e=>{let[s,a]=e;return(0,r.jsxs)("label",{className:"block",children:[(0,r.jsxs)("span",{className:"text-gray-700 capitalize",children:[s," (%)"]}),(0,r.jsx)("input",{type:"number",name:s,value:a,onChange:p,className:"mt-1 px-4 py-2 bg-gray-100 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"})]},s)})}),(0,r.jsxs)("div",{className:"flex flex-row gap-6",children:[(0,r.jsx)("button",{onClick:f,className:"mt-8 bg-[#4c7380] cursor-pointer hover:bg-[#FFA07A] text-white font-bold py-2 px-4 rounded-full",children:"Save"}),(0,r.jsx)("button",{onClick:()=>e.push("/"),className:"mt-8 bg-[#4c7380] cursor-pointer hover:bg-[#FFA07A] text-white font-bold py-2 px-4 rounded-full",children:"Return Home"})]})]})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[992,399,441,684,358],()=>s(7209)),_N_E=e.O()}]);