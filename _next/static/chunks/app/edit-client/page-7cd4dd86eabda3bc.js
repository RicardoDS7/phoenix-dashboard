(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[41],{3843:(e,a,s)=>{"use strict";s.d(a,{db:()=>c});var l=s(3915),t=s(5317);let r=(0,l.Wp)({apiKey:"AIzaSyDKxm2rzvjgsxfg1vJ6ZgzPJRPfY3R7HR4",authDomain:"phoenix-energy-firebase.firebaseapp.com",projectId:"phoenix-energy-firebase",storageBucket:"phoenix-energy-firebase.firebasestorage.app",messagingSenderId:"82665667347",appId:"1:82665667347:web:a6dab9227aa655573638e6",measurementId:"G-1CQS4L7V4Y"}),c=(0,t.aU)(r)},5695:(e,a,s)=>{"use strict";var l=s(8999);s.o(l,"useRouter")&&s.d(a,{useRouter:function(){return l.useRouter}})},7209:(e,a,s)=>{Promise.resolve().then(s.bind(s,8305))},8305:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>i});var l=s(5155),t=s(2115),r=s(5317),c=s(3843),n=s(5695);function i(){let e=(0,n.useRouter)(),[a,s]=(0,t.useState)([]),[i,d]=(0,t.useState)([]),[o,u]=(0,t.useState)([]),[p,m]=(0,t.useState)(""),[x,g]=(0,t.useState)({projectName:"",siteAddress:"",latitude:"",longitude:"",projectEPC:"",projectDetails:"",tariffType:"",nmd:"",selectedLoadProfile:"",usage:{jan:"",feb:"",mar:"",apr:"",may:"",jun:"",jul:"",aug:"",sep:"",oct:"",nov:"",dec:""},fractions:{offpeak:"",standard:"",peak:""}});(0,t.useEffect)(()=>{(async function(){try{let e=await (0,r.GG)((0,r.rJ)(c.db,"eskom_tariffs")),a=await (0,r.GG)((0,r.rJ)(c.db,"load_profiles")),l=await (0,r.GG)((0,r.rJ)(c.db,"clients"));s(e.docs.map(e=>e.id)),d(a.docs.map(e=>e.id)),u(l.docs.map(e=>e.id))}catch(e){console.error("Error fetching data:",e)}})()},[]),(0,t.useEffect)(()=>{(async function(){if(p)try{let e=await (0,r.x7)((0,r.H9)(c.db,"clients",p));if(e.exists()){let a=e.data().projectDetails;g({projectName:p,siteAddress:a.siteAddress||"",latitude:a.latitude||"",longitude:a.longitude||"",projectEPC:a.projectEPC||"",projectDetails:a.projectDetails||"",tariffType:a.tariffType||"",nmd:a.nmd||"",selectedLoadProfile:a.selectedLoadProfile||"",usage:{...a.usage},fractions:{...a.fractions}})}}catch(e){console.error("Error loading client data:",e)}})()},[p]);let f=e=>{let{name:a,value:s}=e.target;a in x.usage?g(e=>({...e,usage:{...e.usage,[a]:s}})):a in x.fractions?g(e=>({...e,fractions:{...e.fractions,[a]:s}})):g(e=>({...e,[a]:s}))},b=async()=>{if(!p)return alert("Select a client first");try{await (0,r.BN)((0,r.H9)(c.db,"clients",p),{projectDetails:{siteAddress:x.siteAddress,latitude:x.latitude,longitude:x.longitude,projectEPC:x.projectEPC,projectDetails:x.projectDetails,tariffType:x.tariffType,nmd:x.nmd,selectedLoadProfile:x.selectedLoadProfile,usage:{...x.usage},fractions:{...x.fractions},updatedAt:new Date}},{merge:!0}),alert("Client updated successfully!")}catch(e){console.error("Error updating client:",e),alert("Error updating client")}};return(0,l.jsxs)("div",{className:"min-h-screen flex flex-col justify-center items-center p-4",children:[(0,l.jsx)("h1",{className:"text-6xl font-black mb-16",children:"Edit Client Details"}),(0,l.jsx)("div",{className:"w-full max-w-4xl mb-8",children:(0,l.jsxs)("label",{className:"block",children:[(0,l.jsx)("span",{className:"text-gray-700",children:"Select Client"}),(0,l.jsxs)("select",{value:p,onChange:e=>m(e.target.value),className:"mt-1 px-4 py-2 bg-gray-100 block w-full rounded-md",children:[(0,l.jsx)("option",{value:"",children:"Select a client"}),o.map(e=>(0,l.jsx)("option",{value:e,children:e},e))]})]})}),p&&(0,l.jsxs)("form",{onSubmit:e=>e.preventDefault(),className:"grid grid-cols-1 gap-6 max-w-4xl w-full",children:[(0,l.jsxs)("label",{className:"block",children:[(0,l.jsx)("span",{className:"text-gray-700",children:"Project Name"}),(0,l.jsx)("input",{type:"text",name:"projectName",value:x.projectName,disabled:!0,className:"mt-1 px-4 py-2 bg-gray-100 block w-full rounded-md"})]}),(0,l.jsxs)("label",{className:"block",children:[(0,l.jsx)("span",{className:"text-gray-700",children:"Site Address"}),(0,l.jsx)("input",{type:"text",name:"siteAddress",value:x.siteAddress,onChange:f,className:"mt-1 px-4 py-2 bg-gray-100 block w-full rounded-md"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,l.jsxs)("label",{className:"block",children:[(0,l.jsx)("span",{className:"text-gray-700",children:"Latitude"}),(0,l.jsx)("input",{type:"text",name:"latitude",value:x.latitude,onChange:f,className:"mt-1 px-4 py-2 bg-gray-100 block w-full rounded-md"})]}),(0,l.jsxs)("label",{className:"block",children:[(0,l.jsx)("span",{className:"text-gray-700",children:"Longitude"}),(0,l.jsx)("input",{type:"text",name:"longitude",value:x.longitude,onChange:f,className:"mt-1 px-4 py-2 bg-gray-100 block w-full rounded-md"})]})]}),(0,l.jsxs)("label",{className:"block",children:[(0,l.jsx)("span",{className:"text-gray-700",children:"Project EPC"}),(0,l.jsx)("input",{type:"text",name:"projectEPC",value:x.projectEPC,onChange:f,className:"mt-1 px-4 py-2 bg-gray-100 block w-full rounded-md"})]}),(0,l.jsxs)("label",{className:"block",children:[(0,l.jsx)("span",{className:"text-gray-700",children:"Project Details"}),(0,l.jsx)("textarea",{name:"projectDetails",value:x.projectDetails,onChange:f,className:"mt-1 px-4 py-2 bg-gray-100 block w-full rounded-md"})]}),(0,l.jsxs)("label",{className:"block",children:[(0,l.jsx)("span",{className:"text-gray-700",children:"Tariff Type"}),(0,l.jsxs)("select",{name:"tariffType",value:x.tariffType,onChange:f,className:"mt-1 px-4 py-2 bg-gray-100 block w-full rounded-md",children:[(0,l.jsx)("option",{value:"",children:"Select a tariff"}),a.map(e=>(0,l.jsx)("option",{value:e,children:e},e))]})]}),(0,l.jsxs)("label",{className:"block",children:[(0,l.jsx)("span",{className:"text-gray-700",children:"Load Profile"}),(0,l.jsxs)("select",{name:"selectedLoadProfile",value:x.selectedLoadProfile,onChange:f,className:"mt-1 px-4 py-2 bg-gray-100 block w-full rounded-md",children:[(0,l.jsx)("option",{value:"",children:"Select a profile"}),i.map(e=>(0,l.jsx)("option",{value:e,children:e},e))]})]}),(0,l.jsxs)("label",{className:"block",children:[(0,l.jsx)("span",{className:"text-gray-700",children:"NMD (kVA)"}),(0,l.jsx)("input",{type:"number",name:"nmd",value:x.nmd,onChange:f,className:"mt-1 px-4 py-2 bg-gray-100 block w-full rounded-md"})]}),(0,l.jsx)("h3",{className:"text-2xl font-bold mt-6",children:"Monthly Usage (kWh)"}),(0,l.jsx)("div",{className:"grid grid-cols-3 gap-4",children:Object.entries(x.usage).map(e=>{let[a,s]=e;return(0,l.jsxs)("label",{className:"block",children:[(0,l.jsx)("span",{className:"capitalize text-gray-700",children:a}),(0,l.jsx)("input",{type:"number",name:a,value:s,onChange:f,className:"mt-1 px-4 py-2 bg-gray-100 block w-full rounded-md"})]},a)})}),(0,l.jsx)("h3",{className:"text-2xl font-bold mt-6",children:"TOU Distribution (%)"}),(0,l.jsx)("div",{className:"grid grid-cols-3 gap-4",children:Object.entries(x.fractions).map(e=>{let[a,s]=e;return(0,l.jsxs)("label",{className:"block",children:[(0,l.jsx)("span",{className:"capitalize text-gray-700",children:a}),(0,l.jsx)("input",{type:"number",name:a,value:s,onChange:f,className:"mt-1 px-4 py-2 bg-gray-100 block w-full rounded-md"})]},a)})}),(0,l.jsxs)("div",{className:"flex flex-row gap-4 mt-6",children:[(0,l.jsx)("button",{onClick:b,className:"bg-[#4c7380] hover:bg-[#FFA07A] text-white font-bold py-2 px-4 rounded-full",children:"Save"}),(0,l.jsx)("button",{onClick:()=>e.push("/"),className:"bg-[#4c7380] hover:bg-[#FFA07A] text-white font-bold py-2 px-4 rounded-full",children:"Return Home"})]})]})]})}}},e=>{var a=a=>e(e.s=a);e.O(0,[992,399,441,684,358],()=>a(7209)),_N_E=e.O()}]);